require 'spec_helper'

describe Tapyrus::Message::HeaderAndShortIDs do
  describe '#short_id' do
    subject do
      Tapyrus::Message::HeaderAndShortIDs.parse_from_payload(
        '0100000006d1d602bae800102d3a615fb1d546599308435762d03a8d59e4a7bb35bb7e2abfdb311f857e830878fbb88e1f8dbde23c384db591ceb0c622aa252e2a56a7f6f1f4c8a0b9c648ea35175f91786b12b66bff4d0b3c77562db3b369aadb896777439c235f00406363110e643f3c9580f99c06783d2c85bda3ae9ceb62b79c5a622bf5cb662a0a9b3e8230f29c73793367f1828664a4b4778e2211f97d3d47be822c370792284d000000000000000005c6d41957ce771d1553767292561554210ee32eade5fdda5fe92e2b3f0a310100010000000100000000000000000000000000000000000000000000000000000000000000007e00000000ffffffff0100f2052a01000000015100000000'
          .htb
      )
    end
    it 'should calculate transaction short id.' do
      expect(subject.short_id('282cf67861a83768c9321496aa35e6a720442a53e87780abca74a5f5919f405a')).to eq(
        131_728_108_278_982
      )
      expect(subject.short_id('356ecf9f4c9961c6a265e08159770f0f2bb539e946048bd7579a1b3b14734617')).to eq(
        161_020_309_083_421
      )
    end
  end
end
